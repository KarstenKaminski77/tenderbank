/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
function ImageManager(b){}ImageManager._pluginInfo={name:"ImageManager",version:"1.0",developer:"Xiang Wei Zhuo",developer_url:"http://www.zhuo.org/htmlarea/",license:"htmlArea"};Xinha.Config.prototype.ImageManager={backend:Xinha.getPluginDir("ImageManager")+"/backend.php?__plugin=ImageManager&",backend_data:null,backend_config:null,backend_config_hash:null,backend_config_secret_key_location:"Xinha:ImageManager"};Xinha.prototype._insertImage=function(n){var l=this;var m=null;if(typeof n=="undefined"){n=this.getParentElement();if(n&&!/^img$/i.test(n.tagName)){n=null}}if(n){m={f_url:Xinha.is_ie?n.src:n.src,f_alt:n.alt,f_border:n.style.borderWidth?n.style.borderWidth:n.border,f_align:n.align,f_padding:n.style.padding,f_margin:n.style.margin,f_width:n.width,f_height:n.height,f_backgroundColor:n.style.backgroundColor,f_borderColor:n.style.borderColor,f_hspace:n.hspace&&n.hspace!="-1"?parseInt(n.hspace):"",f_vspace:n.vspace&&n.vspace!="-1"?parseInt(n.vspace):""};function i(b){if(/ /.test(b)){var c=b.split(" ");var d=true;for(var a=1;a<c.length;a++){if(c[0]!=c[a]){d=false;break}}if(d){b=c[0]}}return b}m.f_border=i(m.f_border);m.f_padding=i(m.f_padding);m.f_margin=i(m.f_margin);function h(a){if(typeof a=="string"&&/, /.test.color){a=a.replace(/, /,",")}if(typeof a=="string"&&/ /.test.color){var c=a.split(" ");var b="";for(var d=0;d<c.length;d++){b+=Xinha._colorToRgb(c[d]);if(d+1<c.length){b+=" "}}return b}return Xinha._colorToRgb(a)}m.f_backgroundColor=h(m.f_backgroundColor);m.f_borderColor=h(m.f_borderColor)}var j=l.config.ImageManager.backend+"__function=manager";if(l.config.ImageManager.backend_config!=null){j+="&backend_config="+encodeURIComponent(l.config.ImageManager.backend_config);j+="&backend_config_hash="+encodeURIComponent(l.config.ImageManager.backend_config_hash);j+="&backend_config_secret_key_location="+encodeURIComponent(l.config.ImageManager.backend_config_secret_key_location)}if(l.config.ImageManager.backend_data!=null){for(var k in l.config.ImageManager.backend_data){j+="&"+k+"="+encodeURIComponent(l.config.ImageManager.backend_data[k])}}Dialog(j,function(d){if(!d){return false}var b=n;if(!b){if(Xinha.is_ie){var e=l._getSelection();var c=l._createRange(e);l._doc.execCommand("insertimage",false,d.f_url);b=c.parentElement();if(b.tagName.toLowerCase()!="img"){b=b.previousSibling}}else{b=document.createElement("img");b.src=d.f_url;l.insertNodeAtSelection(b)}}else{b.src=d.f_url}for(field in d){var a=d[field];switch(field){case"f_alt":b.alt=a;break;case"f_border":if(a.length){b.style.borderWidth=/[^0-9]/.test(a)?a:(parseInt(a)+"px");if(b.style.borderWidth&&!b.style.borderStyle){b.style.borderStyle="solid"}}else{b.style.borderWidth="";b.style.borderStyle=""}break;case"f_borderColor":b.style.borderColor=a;break;case"f_backgroundColor":b.style.backgroundColor=a;break;case"f_padding":if(a.length){b.style.padding=/[^0-9]/.test(a)?a:(parseInt(a)+"px")}else{b.style.padding=""}break;case"f_margin":if(a.length){b.style.margin=/[^0-9]/.test(a)?a:(parseInt(a)+"px")}else{b.style.margin=""}break;case"f_align":b.align=a;break;case"f_width":if(!isNaN(parseInt(a))){b.width=parseInt(a)}else{b.width=""}break;case"f_height":if(!isNaN(parseInt(a))){b.height=parseInt(a)}else{b.height=""}break;case"f_hspace":if(!isNaN(parseInt(a))){b.hspace=parseInt(a)}else{b.hspace=""}break;case"f_vspace":if(!isNaN(parseInt(a))){b.vspace=parseInt(a)}else{b.vspace=""}break}}},m)};