/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
function Abbreviation(f){this.editor=f;var e=f.config;var d=this;e.registerButton({id:"abbreviation",tooltip:Xinha._lc("Abbreviation","Abbreviation"),image:f.imgURL("ed_abbreviation.gif","Abbreviation"),textMode:false,action:function(a){d.show()}});e.addToolbarElement("abbreviation","inserthorizontalrule",1)}Abbreviation._pluginInfo={name:"Abbreviation",version:"1.0",developer:"Udo Schmal",developer_url:"",sponsor:"L.N.Schaffrath NeueMedien",sponsor_url:"http://www.schaffrath-neuemedien.de/",c_owner:"Udo Schmal & Schaffrath-NeueMedien",license:"htmlArea"};Abbreviation.prototype.fillText=function(){var editor=this.editor;var text=this.html.toUpperCase();var abbr=Xinha.getPluginDir(this.constructor.name)+"/abbr/"+_editor_lang+".js";var abbrData=Xinha._geturlcontent(abbr);if(abbrData){eval("abbrObj = "+abbrData);if(abbrObj!=""){var dest=this.dialog.getElementById("title");dest.value=this.title||"";for(var i in abbrObj){same=(i.toUpperCase()==text);if(same){dest.value=abbrObj[i]}}}}};Abbreviation.prototype.onGenerateOnce=function(c){this.editor.addEditorStylesheet(Xinha.getPluginDir("Abbreviation")+"/abbreviation.css");this.methodsReady=true;var d=Abbreviation;Xinha._getback(Xinha.getPluginDir("Abbreviation")+"/dialog.html",function(a){d.html=a;d.dialogReady=true})};Abbreviation.prototype.OnUpdateToolbar=function(b){if(!(Abbreviation.dialogReady&&Abbreviation.methodsReady)){this.editor._toolbarObjects.Abbreviation.state("enabled",false)}else{this.onUpdateToolbar=null}};Abbreviation.prototype.prepareDialog=function(g){var e=this;var f=this.editor;var h=this.dialog=new Xinha.Dialog(f,Abbreviation.html,"Xinha",{width:260,height:140});h.getElementById("ok").onclick=function(){e.apply()};h.getElementById("delete").onclick=function(){e.ondelete()};h.getElementById("cancel").onclick=function(){e.dialog.hide()};this.dialogReady=true};Abbreviation.prototype.show=function(l){var l=this.editor;this.html=l.getSelectedHTML();if(!this.dialog){this.prepareDialog()}var g=this;var i=l._doc;var j=l._getSelection();var h=l._createRange(j);var k=l._activeElement(j);if(!(k!=null&&k.tagName.toLowerCase()=="abbr")){k=l._getFirstAncestor(j,"abbr")}this.abbr=k;if(k){this.title=k.title}this.fillText();this.dialog.getElementById("inputs").onsubmit=function(){g.apply();return false};this.dialog.show();this.dialog.getElementById("title").select()};Abbreviation.prototype.apply=function(){var j=this.editor;var n=j._doc;var e=this.abbr;var p=this.html;var l=this.dialog.hide();if(l){var m=l.title;if(m==""||m==null){if(e){var k=e.innerHTML;e.parentNode.removeChild(e);j.insertHTML(k)}return}try{if(!e){e=n.createElement("abbr");e.title=m;e.innerHTML=p;if(Xinha.is_ie){range.pasteHTML(e.outerHTML)}else{j.insertNodeAtSelection(e)}}else{e.title=m}}catch(o){}}};Abbreviation.prototype.ondelete=function(){this.dialog.getElementById("title").value="";this.apply()};