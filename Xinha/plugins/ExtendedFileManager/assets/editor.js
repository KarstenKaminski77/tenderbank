/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
var current_action=null;var actions=["crop","scale","rotate","measure","save"];var orginal_width=null,orginal_height=null;function toggle(i){if(current_action!=i){for(var h in actions){if(actions[h]!=i){var s=document.getElementById("tools_"+actions[h]);s.style.display="none";var p=document.getElementById("icon_"+actions[h]);p.className=""}}current_action=i;var s=document.getElementById("tools_"+i);s.style.display="block";var p=document.getElementById("icon_"+i);p.className="iconActive";var m=document.getElementById("indicator_image");m.src="img/"+i+".gif";editor.setMode(current_action);if(i=="scale"){var q=editor.window.document.getElementById("theImage");orginal_width=q._width;orginal_height=q._height;var o=document.getElementById("sw");o.value=orginal_width;var t=document.getElementById("sh");t.value=orginal_height}if(i=="save"){var r=document.getElementById("save_format");var n=document.getElementById("save_filename").value.match(/\.(gif|png|jpe?g)/i)[1].toLowerCase();switch(n){case"png":r.selectedIndex="3";break;case"gif":r.selectedIndex="4";break;default:r.selectedIndex="0";break}r.onchange()}}}function toggleMarker(){var b=document.getElementById("markerImg");if(b!=null&&b.src!=null){if(b.src.indexOf("t_black.gif")>=0){b.src="img/t_white.gif"}else{b.src="img/t_black.gif"}editor.toggleMarker()}}function toggleConstraints(){var d=document.getElementById("scaleConstImg");var c=document.getElementById("constProp");if(d!=null&&d.src!=null){if(d.src.indexOf("unlocked2.gif")>=0){d.src="img/islocked2.gif";c.checked=true;checkConstrains("width")}else{d.src="img/unlocked2.gif";c.checked=false}}}function checkConstrains(k){var i=document.getElementById("constProp");if(i.checked){var j=document.getElementById("sw");var g=j.value;var h=document.getElementById("sh");var l=h.value;if(orginal_width>0&&orginal_height>0){if(k=="width"&&g>0){h.value=parseInt((g/orginal_width)*orginal_height)}else{if(k=="height"&&l>0){j.value=parseInt((l/orginal_height)*orginal_width)}}}}updateMarker("scale")}function updateMarker(n){if(n=="crop"){var h=document.getElementById("cx");var i=document.getElementById("cy");var m=document.getElementById("cw");var k=document.getElementById("ch");editor.setMarker(parseInt(h.value),parseInt(i.value),parseInt(m.value),parseInt(k.value))}else{if(n=="scale"){var l=document.getElementById("sw");var j=document.getElementById("sh");editor.setMarker(0,0,parseInt(l.value),parseInt(j.value))}}}function rotateSubActionSelect(h){var g=h.options[h.selectedIndex].value;var i=document.getElementById("rotate_preset_select");var f=document.getElementById("flip");var j=document.getElementById("ra").parentNode;switch(g){case"rotate":i.style.display="";f.style.display="none";j.style.display="";break;case"flip":i.style.display="none";f.style.display="";j.style.display="none";break}}function rotatePreset(d){var f=d.options[d.selectedIndex].value;if(f.length>0&&parseInt(f)!=0){var e=document.getElementById("ra");e.value=parseInt(f)}}function updateFormat(d){var e=d.options[d.selectedIndex].value;var f=e.split(",");if(f[0]!="jpeg"){document.getElementById("slider").style.display="none"}else{document.getElementById("slider").style.display="inline"}if(f.length>1){updateSlider(parseInt(f[1]))}}function zoom(){var d=editor.window.document.getElementById("theImage");var c=document.getElementById("zoom").value;d.width=d._width*parseInt(c,10)/100;d.height=d._height*parseInt(c,10)/100;editor.reset();editor.pic_width=null;editor.pic_height=null}function addEvent(e,h,g){if(e.addEventListener){e.addEventListener(h,g,true);return true}else{if(e.attachEvent){var f=e.attachEvent("on"+h,g);return f}else{return false}}}var init=function(){if(window.opener){__xinha_dlg_init();__dlg_translate("ExtendedFileManager")}addEvent(window,"resize",winOnResize);try{window.moveTo(0,0)}catch(b){}window.resizeTo(window.screen.availWidth,window.screen.availHeight);winOnResize()};function winOnResize(){if(typeof editor.reset=="function"&&typeof editor.ant!="undefined"){editor.reset()}var b=Xinha.viewportSize(window);document.getElementById("contents").style.height=b.y-parseInt(document.getElementById("indicator").offsetHeight,10)-5+"px"}Xinha.addOnloadHandler(init,window);