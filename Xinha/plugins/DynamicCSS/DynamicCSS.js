/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
function DynamicCSS(p,n){this.editor=p;var h=p.config;var q=this;var l=null;var o=null;var m={id:"DynamicCSS-class",tooltip:this._lc("Choose stylesheet"),options:{"":""},action:function(a){q.onSelect(a,this)},refresh:function(a){q.updateValue(a,this)}};h.registerDropdown(m);h.addToolbarElement(["T[CSS]","DynamicCSS-class","separator"],"formatblock",-1)}DynamicCSS.parseStyleSheet=function(d){iframe=d._iframe.contentWindow.document;cssArray=DynamicCSS.cssArray;if(!cssArray){cssArray=new Array()}for(i=0;i<iframe.styleSheets.length;i++){if(iframe.styleSheets[i].title=="XinhaInternalCSS"){continue}if(Xinha.is_gecko){try{cssArray=DynamicCSS.applyCSSRule(iframe.styleSheets[i].cssRules,cssArray)}catch(c){}}else{try{if(iframe.styleSheets[i].rules){cssArray=DynamicCSS.applyCSSRule(iframe.styleSheets[i].rules,cssArray)}if(iframe.styleSheets[i].imports){for(j=0;j<iframe.styleSheets[i].imports.length;j++){cssArray=DynamicCSS.applyCSSRule(iframe.styleSheets[i].imports[j].rules,cssArray)}}}catch(c){}}}DynamicCSS.cssArray=cssArray};DynamicCSS.applyCSSRule=function(c,d){for(rule in c){if(typeof c[rule]=="function"){continue}if(c[rule].selectorText){if(c[rule].selectorText.search(/:+/)==-1){cssElements=c[rule].selectorText.split(",");for(k=0;k<cssElements.length;k++){cssElement=cssElements[k].split(".");tagName=cssElement[0].toLowerCase().trim();className=cssElement[1];if(!tagName){tagName="all"}if(!d[tagName]){d[tagName]=new Array()}if(className){if(tagName=="all"){cssName=className}else{cssName="<"+className+">"}}else{className="none";if(tagName=="all"){cssName=Xinha._lc("Default","DynamicCSS")}else{cssName="<"+Xinha._lc("Default","DynamicCSS")+">"}}d[tagName][className]=cssName;DynamicCSS.cssLength++}}}else{if(c[rule].styleSheet){d=DynamicCSS.applyCSSRule(c[rule].styleSheet.cssRules,d)}}}return d};DynamicCSS._pluginInfo={name:"DynamicCSS",version:"1.5.2",developer:"Holger Hees",developer_url:"http://www.systemconcept.de/",c_owner:"Holger Hees",sponsor:"System Concept GmbH",sponsor_url:"http://www.systemconcept.de/",license:"htmlArea"};DynamicCSS.prototype._lc=function(b){return Xinha._lc(b,"DynamicCSS")};DynamicCSS.prototype.onSelect=function(m,g){var h=m._toolbarObjects[g.id];var l=h.element.selectedIndex;var n=h.element.value;var o=m.getParentElement();if(n!="none"){o.className=n;DynamicCSS.lastClass=n}else{if(Xinha.is_gecko){o.removeAttribute("class")}else{o.removeAttribute("className")}}m.updateToolbar()};DynamicCSS.prototype.reparseTimer=function(f,e,d){if(DynamicCSS.parseCount<9){setTimeout(function(){DynamicCSS.cssLength=0;DynamicCSS.parseStyleSheet(f);if(DynamicCSS.cssOldLength!=DynamicCSS.cssLength){DynamicCSS.cssOldLength=DynamicCSS.cssLength;DynamicCSS.lastClass=null;d.updateValue(f,e)}d.reparseTimer(f,e,d)},DynamicCSS.parseCount*1000);DynamicCSS.parseCount=DynamicCSS.parseCount*2}};DynamicCSS.prototype.updateValue=function(n,t){cssArray=DynamicCSS.cssArray;if(!cssArray){DynamicCSS.cssLength=0;DynamicCSS.parseStyleSheet(n);cssArray=DynamicCSS.cssArray;DynamicCSS.cssOldLength=DynamicCSS.cssLength;DynamicCSS.parseCount=1;this.reparseTimer(n,t,this)}var q=n.getParentElement();var s=q.tagName.toLowerCase();var o=q.className;if(this.lastTag!=s||this.lastClass!=o){this.lastTag=s;this.lastClass=o;var p=n._toolbarObjects[t.id].element;while(p.length>0){p.options[p.length-1]=null}p.options[0]=new Option(this._lc("Default"),"none");if(cssArray){if(s!="body"||n.config.fullPage){if(cssArray[s]){for(cssClass in cssArray[s]){if(typeof cssArray[s][cssClass]!="string"){continue}if(cssClass=="none"){p.options[0]=new Option(cssArray[s][cssClass],cssClass)}else{p.options[p.length]=new Option(cssArray[s][cssClass],cssClass)}}}if(cssArray.all){for(cssClass in cssArray.all){if(typeof cssArray.all[cssClass]!="string"){continue}p.options[p.length]=new Option(cssArray.all[cssClass],cssClass)}}}else{if(cssArray[s]&&cssArray[s]["none"]){p.options[0]=new Option(cssArray[s]["none"],"none")}}}p.selectedIndex=0;if(typeof o!="undefined"&&/\S/.test(o)){var r=p.options;for(var u=r.length;--u>=0;){var m=r[u];if(o==m.value){p.selectedIndex=u;break}}if(p.selectedIndex==0){p.options[p.length]=new Option(this._lc("Undefined"),o);p.selectedIndex=p.length-1}}if(p.length>1){p.disabled=false}else{p.disabled=true}}};