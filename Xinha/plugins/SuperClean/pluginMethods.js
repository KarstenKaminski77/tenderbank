/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
SuperClean.prototype._superClean=function(opts,obj){if(this.editor.config.SuperClean.show_dialog&&!this._dialog){this._dialog=new SuperClean.Dialog(this)}var superclean=this;var doOK=function(){superclean._dialog.dialog.getElementById("main").style.display="none";superclean._dialog.dialog.getElementById("waiting").style.display="";superclean._dialog.dialog.getElementById("buttons").style.display="none";var opts=superclean._dialog.dialog.getValues();var editor=superclean.editor;if(opts.word_clean){editor._wordClean()}var D=editor.getEditorContent();for(var filter in editor.config.SuperClean.filters){if(filter=="tidy"||filter=="word_clean"){continue}if(opts[filter]){D=SuperClean.filterFunctions[filter](D,editor)}}D=D.replace(/(style|class)="\s*"/gi,"");D=D.replace(/<(font|span)\s*>/gi,"");editor.setEditorContent(D);if(opts.tidy){var callback=function(javascriptResponse){eval("var response = "+javascriptResponse);switch(response.action){case"setHTML":editor.setEditorContent(response.value);superclean._dialog.hide();break;case"alert":superclean._dialog.dialog.getElementById("buttons").style.display="";superclean._dialog.dialog.getElementById("ok").style.display="none";superclean._dialog.dialog.getElementById("waiting").style.display="none";superclean._dialog.dialog.getElementById("alert").style.display="";superclean._dialog.dialog.getElementById("alert").innerHTML=superclean._lc(response.value);break;default:superclean._dialog.hide();break}};var args=editor.config.SuperClean.tidy_args;if(typeof args!="object"){args={}}args.content=editor.getInnerHTML();Xinha._postback(editor.config.SuperClean.tidy_handler,args,callback)}else{superclean._dialog.hide()}return true};if(this.editor.config.SuperClean.show_dialog){var inputs={};this._dialog.show(inputs,doOK)}else{var editor=this.editor;var html=editor.getEditorContent();for(var filter in editor.config.SuperClean.filters){if(filter=="tidy"){continue}html=SuperClean.filterFunctions[filter](html,editor)}html=html.replace(/(style|class)="\s*"/gi,"");html=html.replace(/<(font|span)\s*>/gi,"");editor.setEditorContent(html);if(editor.config.SuperClean.filters.tidy){SuperClean.filterFunctions.tidy(html,editor)}}};SuperClean.filterFunctions.remove_colors=function(b){b=b.replace(/color="?[^" >]*"?/gi,"");b=b.replace(/([^-])color:[^;}"']+;?/gi,"$1");return(b)};SuperClean.filterFunctions.remove_sizes=function(b){b=b.replace(/size="?[^" >]*"?/gi,"");b=b.replace(/font-size:[^;}"']+;?/gi,"");return(b)};SuperClean.filterFunctions.remove_faces=function(b){b=b.replace(/face="?[^" >]*"?/gi,"");b=b.replace(/font-family:[^;}"']+;?/gi,"");return(b)};SuperClean.filterFunctions.remove_lang=function(b){b=b.replace(/lang="?[^" >]*"?/gi,"");return(b)};SuperClean.filterFunctions.word_clean=function(c,d){d.setHTML(c);d._wordClean();return d.getInnerHTML()};SuperClean.filterFunctions.remove_fancy_quotes=function(b){b=b.replace(new RegExp(String.fromCharCode(8216),"g"),"'");b=b.replace(new RegExp(String.fromCharCode(8217),"g"),"'");b=b.replace(new RegExp(String.fromCharCode(8218),"g"),"'");b=b.replace(new RegExp(String.fromCharCode(8219),"g"),"'");b=b.replace(new RegExp(String.fromCharCode(8220),"g"),'"');b=b.replace(new RegExp(String.fromCharCode(8221),"g"),'"');b=b.replace(new RegExp(String.fromCharCode(8222),"g"),'"');b=b.replace(new RegExp(String.fromCharCode(8223),"g"),'"');return b};SuperClean.filterFunctions.tidy=function(html,editor){var callback=function(javascriptResponse){eval("var response = "+javascriptResponse);switch(response.action){case"setHTML":editor.setEditorContent(response.value);break;case"alert":alert(Xinha._lc(response.value,"SuperClean"));break}};var args=editor.config.SuperClean.tidy_args;if(typeof args!="object"){args={}}args.content=html;Xinha._postback(editor.config.SuperClean.tidy_handler,args,callback)};SuperClean.Dialog=function(c){var d=this;this.Dialog_nxtid=0;this.SuperClean=c;this.id={};this.ready=false;this.dialog=false;this._prepareDialog()};SuperClean.Dialog.prototype._prepareDialog=function(){var h=this;var n=this.SuperClean;var i=window.SuperClean.html;var m="";for(var l in this.SuperClean.editor.config.SuperClean.filters){m+="    <div>\n";var j=this.SuperClean.editor.config.SuperClean.filters[l];if(typeof j.label=="undefined"){m+='        <input type="checkbox" name="['+l+']" id="['+l+']" checked value="on" />\n';m+='        <label for="['+l+']">'+this.SuperClean.editor.config.SuperClean.filters[l]+"</label>\n"}else{m+='        <input type="checkbox" name="['+l+']" id="['+l+']" value="on"'+(j.checked?"checked":"")+" />\n";m+='        <label for="['+l+']">'+j.label+"</label>\n"}m+="    </div>\n"}i=i.replace("<!--filters-->",m);var k=this.dialog=new Xinha.Dialog(n.editor,i,"SuperClean",{width:400});this.ready=true};SuperClean.Dialog.prototype._lc=SuperClean.prototype._lc;SuperClean.Dialog.prototype.show=function(f,g,i){if(!this.ready){var j=this;window.setTimeout(function(){j.show(f,g,i)},100);return}var h=this.dialog;var j=this;if(g){this.dialog.getElementById("ok").onclick=g}else{this.dialog.getElementById("ok").onclick=function(){j.hide()}}if(i){this.dialog.getElementById("cancel").onclick=i}else{this.dialog.getElementById("cancel").onclick=function(){j.hide()}}this.SuperClean.editor.disableToolbar(["fullscreen","SuperClean"]);this.dialog.show(f);this.dialog.onresize()};SuperClean.Dialog.prototype.hide=function(){var b=this.dialog.hide();this.SuperClean.editor.enableToolbar();this.dialog.getElementById("main").style.display="";this.dialog.getElementById("buttons").style.display="";this.dialog.getElementById("waiting").style.display="none";this.dialog.getElementById("alert").style.display="none";this.dialog.getElementById("ok").style.display="";return b};