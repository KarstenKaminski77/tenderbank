/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
function LangMarks(j,h){this.editor=j;var l=j.config;var k=this;var m={};m[this._lc("&mdash; language &mdash;")]="";if(!l.LangMarks.languages){Xinha.debugMsg("Warning: Old style LangMarks configuration detected, please update your LangMarks configuration.");var i={languages:[],attributes:Xinha.Config.prototype.attributes};for(var n in l.LangMarks){if(typeof n!="string"){continue}i.languages.push({name:n,code:l.LangMarks[n]})}l.LangMarks=i}for(var n=0;n<l.LangMarks.languages.length;n++){m[this._lc(l.LangMarks.languages[n].name)]=l.LangMarks.languages[n].code}l.registerDropdown({id:"langmarks",tooltip:this._lc("language select"),options:m,action:function(a){k.onSelect(a,this)},refresh:function(a){k.updateValue(a,this)}});l.addToolbarElement("langmarks","inserthorizontalrule",1)}LangMarks._pluginInfo={name:"LangMarks",version:"1.0",developer:"Udo Schmal",developer_url:"",sponsor:"L.N.Schaffrath NeueMedien",sponsor_url:"http://www.schaffrath-neuemedien.de/",c_owner:"Udo Schmal & Schaffrath NeueMedien",license:"htmlArea"};Xinha.Config.prototype.LangMarks={languages:[{name:"Greek",code:"el"},{name:"English",code:"en"},{name:"French",code:"fr"},{name:"Latin",code:"la"}],attributes:["lang","xml:lang"]};LangMarks.prototype._lc=function(b){return Xinha._lc(b,"LangMarks")};LangMarks.prototype.onGenerate=function(){this.editor.addEditorStylesheet(Xinha.getPluginDir("LangMarks")+"/lang-marks.css")};LangMarks.prototype.onSelect=function(s,p,t,u){var x=s._toolbarObjects[p.id];var i=x.element.selectedIndex;var r=x.element.value;var v=s.getParentElement();var w=true;var y=(v&&v.tagName.toLowerCase()=="span");var z=(t&&u&&v&&v.tagName.toLowerCase()==t);if(z){v.className="haslang";v.lang=r;for(var q=0;q<this.editor.config.LangMarks.attributes.length;q++){v.setAttribute(this.editor.config.LangMarks.attributes[q],r)}s.updateToolbar();return}if(y&&i==0&&!/\S/.test(v.style.cssText)){while(v.firstChild){v.parentNode.insertBefore(v.firstChild,v)}v.parentNode.removeChild(v);s.updateToolbar();return}if(y){if(v.childNodes.length==1){v.className="haslang";v.lang=r;for(var q=0;q<this.editor.config.LangMarks.attributes.length;q++){v.setAttribute(this.editor.config.LangMarks.attributes[q],r)}w=false;s.updateToolbar()}}if(w){var o="";for(var q=0;q<this.editor.config.LangMarks.attributes.length;q++){o+=" "+this.editor.config.LangMarks.attributes[q]+'="'+r+'"'}s.surroundHTML("<span"+o+' class="haslang">',"</span>")}};LangMarks.prototype.updateValue=function(o,u){var p=o._toolbarObjects[u.id].element;var q=o.getAllAncestors();var r;var n;for(var v=0;v<q.length;v++){for(var i=0;i<o.config.LangMarks.attributes.length;i++){if(q[v].getAttribute(this.editor.config.LangMarks.attributes[i])){r=q[v];n=q[v].getAttribute(this.editor.config.LangMarks.attributes[i])}}}if(r){var t=p.options;var s=n;for(var v=t.length;--v>=0;){var j=t[v];if(s==j.value){p.selectedIndex=v;return}}}else{p.selectedIndex=0}};