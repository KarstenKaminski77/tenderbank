/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
function NoteServer(e){this.editor=e;var d=e.config;var f=this;d.registerButton({id:"insertscore",tooltip:this._lc("Insert GUIDO Music Notation"),image:e.imgURL("note.gif","NoteServer"),textMode:false,action:function(a){f.buttonPress(a)}});d.addToolbarElement("insertscore","insertimage",1)}NoteServer._pluginInfo={name:"NoteServer",version:"1.1",developer:"Richard Christophe",developer_url:"http://piano-go.chez.tiscali.fr/guido.html",c_owner:"Richard Christophe",sponsor:"",sponsor_url:"",license:"htmlArea"};NoteServer.prototype._lc=function(b){return Xinha._lc(b,"NoteServer")};NoteServer.prototype.buttonPress=function(b){b._popupDialog("plugin://NoteServer/codenote",function(a){if(!a){return false}else{IncludeGuido(b,a)}},null)};var noteserveraddress="clef.cs.ubc.ca";var htmlbase="/salieri/nview";var versionstring="";function GetGIFURL(g,f,e){g=escape(g);g=g.replace(/\//g,"%2F");if(!f){f="1.0"}if(!e){e="1"}var h="http://"+noteserveraddress+"/scripts/salieri"+versionstring+"/gifserv.pl?pagewidth=21&pageheight=29.7&zoomfactor="+f+"&pagesizeadjust=yes&outputformat=gif87&pagenum="+e+"&gmndata="+g;return h}function GetMIDIURL(c){c=escape(c);c=c.replace(/\//g,"%2F");var d="http://"+noteserveraddress+"/scripts/salieri"+versionstring+"/midserv.pl?gmndata="+c;return d}function GetAPPLETURL(f,e){f=escape(f);f=f.replace(/\//g,"%2F");var d='<applet code="NoteServerApplet" codebase="http://'+noteserveraddress+htmlbase+'/java"  width=700 height=300><param name=server value="'+noteserveraddress+'"><param name=serverVersion value="'+versionstring+'"><param name=zoomFactor value="'+e+'"><param name=pageWidth value="21"><param name=pageHeight value="29.7"><param name=gmn value="'+f+'"></applet>';return d}function IncludeGuido(q,n){if(!n.f_zoom){zoom=""}var o=GetGIFURL(n.f_code,n.f_zoom,"");var k=GetMIDIURL(n.f_code);var r="<br>";if(n.f_applet==false){if(((navigator.userAgent.toLowerCase().indexOf("msie")!=-1)&&(navigator.userAgent.toLowerCase().indexOf("opera")==-1))){q.focusEditor();q.insertHTML("<img src="+o+">")}else{img=new Image();img.src=o;var l=q._doc;var p=q._getSelection();var m=q._createRange(p);q._doc.execCommand("insertimage",false,img.src)}}else{var j=GetAPPLETURL(n.f_code,n.f_zoom);r=r+j+"<br>"}if(n.f_affcode){r=r+Xinha._lc("GUIDO Code","NoteServer")+" : "+n.f_code+"<br>"}if(n.f_midi){r=r+"<a href="+k+">"+Xinha._lc("MIDI File","NoteServer")+"</a> <br>"}q.focusEditor();q.insertHTML(r)}function IncludeGuidoStringAsApplet(h,f,e){f=escape(f);f=f.replace(/\//g,"%2F");var g='<applet codebase="http://'+noteserveraddress+htmlbase+'/java"\ncode="NoteServerApplet" width=480 height=230><PARAM NAME=server VALUE=\''+noteserveraddress+"'><PARAM NAME=serverVersion VALUE='"+versionstring+"'><PARAM NAME=zoomFactor VALUE='"+e+'\'><param name=pageWidth value="21"><param name=pageHeight value="29.7"><PARAM NAME=gmn VALUE=\''+f+"'></applet>";alert(g);h.focusEditor();h.insertHTML(g)};